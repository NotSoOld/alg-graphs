#include <iostream.h>
#include <fstream.h>
#include <stdlib.h>

int A[21][21] = {
//1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20  21

  0,  5, 19,  0,  0,  0,  0,  0,  0,  0, 70,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,   //1
  0,  0,  0,  0,  0,  0,  0,  0,  0, 78,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,   //2
  0,  0,  0,  0, 40,  0, 40,  0,  0,  0, 35,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,   //3
 20,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,   //4
  0, 35,  0,  0,  0, 20,  0,  0, 40,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,   //5
  0,  0, 15,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,   //6
  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 30,  0,  0,  0,  0,  0, 80,  0,  0,  0,   //7
 45,  0,  0, 25,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,   //8
  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 50,  0,  0,  0, 63,  0,  0,   //9
  0,  0,  0,  0,  0, 20,  0,  0, 12,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,   //10
  0,  0,  0,  0,  0, 23, 30,  0,  0,  0,  0,  0,  0,  0,  0, 25,  0,  0,  0,  0,  0,   //11
  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  7,  0,  0,  0,  0,  0,  0, 30,  0,   //12
  0,  0,  0,  0,  0,  0,  0, 10,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 99,   //13
  0,  0,  0,  0,  0,  0,  0,  0,  0, 15,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,   //14
  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 38,  0,  0,  0,  0,  0,  0,  0,  8,  0,  0,   //15
  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 21,  0,  0,  0,  0,  0,  0,  0,  0,  0,   //16
  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  3,  9,  0,  0,  0,  0,  0,  0, 25,  0,   //17
  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 42,  0,  0,  0, 18,  0,  0,  0, 10,  0,  0,   //18
  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 35,  0,  0,  0,  0,  0,  0, 22,   //19
  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 25,  0,  0,  0,  0, 15,   //20
  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 80, 10,  0,  0,  0    //21
  };
int B[21][21] = {0}, inf = 100000;

int A1[21][21] = {
//1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20  21

  0,  5, 19, 20,  0,  0,  0, 45,  0,  0, 70,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,   //1
  5,  0,  0,  0, 35,  0,  0,  0,  0, 78,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,   //2
 19,  0,  0,  0, 40, 15, 40,  0,  0,  0, 35,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,   //3
 20,  0,  0,  0,  0,  0,  0, 25,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,   //4
  0, 35, 40,  0,  0, 20,  0,  0, 40,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,   //5
  0,  0, 15,  0, 20,  0,  0,  0,  0, 20, 23,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,   //6
  0,  0, 40,  0,  0,  0,  0,  0,  0,  0, 30, 30,  0,  0,  0,  0,  0, 80,  0,  0,  0,   //7
 45,  0,  0, 25,  0,  0,  0,  0,  0,  0,  0,  0, 10,  0,  0,  0,  0,  0,  0,  0,  0,   //8
  0,  0,  0,  0, 40,  0,  0,  0,  0, 12,  0,  0,  0,  0, 50,  0,  0,  0, 63,  0,  0,   //9
  0, 78,  0,  0,  0, 20,  0,  0, 12,  0,  0,  0,  0, 15,  0,  0,  0,  0,  0,  0,  0,   //10
 70,  0, 35,  0,  0, 23, 30,  0,  0,  0,  0,  0,  0,  0, 38, 25,  0, 42,  0,  0,  0,   //11
  0,  0,  0,  0,  0,  0, 30,  0,  0,  0,  0,  0,  7,  0,  0, 21,  3,  0,  0, 30,  0,   //12
  0,  0,  0,  0,  0,  0,  0, 10,  0,  0,  0,  7,  0,  0,  0,  0,  9,  0,  0,  0, 99,   //13
  0,  0,  0,  0,  0,  0,  0,  0,  0, 15,  0,  0,  0,  0,  0,  0,  0,  0, 35,  0,  0,   //14
  0,  0,  0,  0,  0, 50,  0,  0, 50,  0, 38,  0,  0,  0,  0,  0,  0, 18,  8,  0,  0,   //15
  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 25, 21,  0,  0,  0,  0,  0,  0,  0, 25,  0,   //16
  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  3,  9,  0,  0,  0,  0,  0,  0, 25, 80,   //17
  0,  0,  0,  0,  0,  0, 80,  0,  0,  0, 42,  0,  0,  0, 18,  0,  0,  0, 10,  0, 10,   //18
  0,  0,  0,  0,  0,  0,  0,  0, 63,  0,  0,  0,  0, 35,  8,  0,  0,  0, 10,  0, 22,   //19
  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 30,  0,  0,  0, 25, 25,  0,  0,  0, 15,   //20
  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 99,  0,  0,  0, 80, 10, 22, 15,  0    //21
  };

void Output(int iter)  {
  ofstream f;
  f.open("outFloyd.txt", ios::app);
  f << "\n\n\n";
  f << "Iteration #" << iter << endl;
  for(int i = 0; i < 21; i++)  {
    for(int j = 0; j < 21; j++)  {
      f << B[i][j] << "\t";
    }
    f << endl;
  }
  f.close();
}

void Floyd()  {
  for(int i = 0; i < 21; i++)  {
    for(int j = 0; j < 21; j++)  {
      if(i == j)
        B[i][j] = 0;
      else if(A[i][j] == 0)
        B[i][j] = inf;
      else
        B[i][j] = A[i][j];
    }
  }
  ofstream t;
  t.open("logFloyd.txt", ios::out);
  for(int k = 0; k < 21; k++)  {
    for(int i = 0; i < 21; i++)  {
      for(int j = 0; j < 21; j++)  {
        if(i != j)  {
          t << "\nB[" << i+1 << "][" << j+1 << "] > B[" << i+1 << "][" << k+1 << "] + B[" << k+1 << "][" << j+1 << "]?";
          t << "\n" << B[i][j] << " > " << B[i][k] << " + " << B[k][j] << "?";
          if(B[i][j] > (B[i][k] + B[k][j]))  {
            t << "\nYes, new number is ";
            B[i][j] = B[i][k] + B[k][j];
            t << B[i][j];
          }
        }
      }
    }
    Output(k+1);
  }
}

void Prima()  {
  int ost[21][21] = {0}, count = 20;
  bool vis[21] = {false};
  vis[0] = true;
  do  {
    int min = INT_MAX, im, jm;
    for (int i = 0; i < 21; i++)
      for (int j = 0; j < 21; j++)
        if ((A1[i][j] != 0) && (A1[i][j] < min) && (vis[i]) && (!vis[j])) {
          min = A1[i][j];
          im = i;
          jm = j;
        }
        if (min != INT_MAX)  {
          ost[im][jm] = A1[im][jm];
          A1[im][jm] = 0;
          vis[jm] = true;
          count--;
        }
  }  while (count > 0);

  ofstream f;
  f.open("outPrima.txt", ios::out);
  f << "Min tree matrix: \n";
  for (int i = 0; i < 21; i++) {
    f << "\n";
    for (int j = 0; j < 21; j++)
      f << ost[i][j] << "\t";
  }
  f << "\n\n";
}

void main()  {
  Floyd();
  Prima();
  system("pause");
}
